{"version":3,"sources":["../src/WebpackCleanupPlugin.js"],"names":[],"mappings":";;;;AAEA;;;;AACA;;;;;;;;IAEM,oB;AAEJ,kCAA0B;AAAA,QAAd,OAAc,yDAAJ,EAAI;;AAAA;;AACxB,SAAK,OAAL,GAAe,OAAf;AACD;;;;0BAEK,Q,EAAU;AAAA;;AACd,UAAM,aAAa,SAAS,OAAT,CAAiB,MAAjB,CAAwB,IAA3C;;AAEA,eAAS,MAAT,CAAgB,MAAhB,EAAwB,UAAC,KAAD,EAAW;AACjC,YAAI,SAAS,gBAAT,CAA0B,WAA1B,CAAsC,IAAtC,KAA+C,sBAAnD,EAA2E;AACzE;AACD;;AAHgC,uBAKO,MAAK,OALZ;AAAA,wCAKzB,OALyB;AAAA,YAKzB,OALyB,oCAKf,EALe;AAAA,sCAKX,KALW;AAAA,YAKX,KALW,kCAKH,KALG;;;AAOjC,YAAM,SAAS,WAAW,MAAX,GAAoB,CAAnC;AACA,YAAM,SAAS,MAAM,MAAN,GAAe,MAAf,CAAsB,GAAtB,CAA0B;AAAA,iBAAS,MAAM,IAAf;AAAA,SAA1B,CAAf;AACA,YAAM,QAAQ,oCAAkB,UAAlB,EACX,GADW,CACP;AAAA,iBAAQ,KAAK,MAAL,CAAY,MAAZ,CAAR;AAAA,SADO,EAEX,MAFW,CAEJ;AAAA,iBAAQ,QAAQ,OAAR,CAAgB,IAAhB,MAA0B,CAAC,CAA3B,IAAgC,OAAO,OAAP,CAAe,IAAf,MAAyB,CAAC,CAAlE;AAAA,SAFI,EAGX,GAHW,CAGP;AAAA,iBAAW,UAAX,SAAyB,IAAzB;AAAA,SAHO,CAAd;;AAKA,cAAM,OAAN,CAAc,aAAG,UAAjB;;AAEA,YAAI,CAAC,KAAL,EAAY;AACV,kBAAQ,GAAR,CAAY,6CAAZ,EAA2D,MAAM,MAAjE;AACD;AACF,OAnBD;AAoBD;;;;;;AAIH,OAAO,OAAP,GAAiB,oBAAjB","file":"WebpackCleanupPlugin.js","sourcesContent":["/* eslint no-console: 0 */\n\nimport fs from 'fs';\nimport recursiveReadSync from 'recursive-readdir-sync';\n\nclass WebpackCleanupPlugin {\n\n  constructor(options = {}) {\n    this.options = options;\n  }\n\n  apply(compiler) {\n    const outputPath = compiler.options.output.path;\n\n    compiler.plugin('done', (stats) => {\n      if (compiler.outputFileSystem.constructor.name !== 'NodeOutputFileSystem') {\n        return;\n      }\n\n      const { exclude = [], quiet = false } = this.options;\n      // recursiveReadSync returns prefix of outputPath + \"/\"\n      const offset = outputPath.length + 1;\n      const assets = stats.toJson().assets.map(asset => asset.name);\n      const files = recursiveReadSync(outputPath)\n        .map(path => path.substr(offset))\n        .filter(file => exclude.indexOf(file) === -1 && assets.indexOf(file) === -1)\n        .map(file => `${outputPath}/${file}`);\n\n      files.forEach(fs.unlinkSync);\n\n      if (!quiet) {\n        console.log('\\nWebpackCleanupPlugin: %s file(s) deleted.', files.length);\n      }\n    });\n  }\n\n}\n\nmodule.exports = WebpackCleanupPlugin;\n"]}